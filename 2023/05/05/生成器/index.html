<!DOCTYPE html>
<html lang=zh-CN>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:description" content="">
    <meta property="og:type" content="website">
    <meta name="description" content="">
    <meta name="keyword"  content="">
    <link rel="shortcut icon" href="/blog/img/favicon.ico">

    <title>
        
        生成器 - undefined
        
    </title>

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/blog/css/aircloud.css">

    
<link rel="stylesheet" href="/blog/css/gitment.css">

    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_28hi1hpxx24.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>

    









<meta name="generator" content="Hexo 6.3.0"></head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i> 思考、生活、编程 </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar ">
            <img src="/blog/img/user.jpeg" />
        </div>
        <div class="name">
            <i>captain</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a href="/blog/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>主页</span>
                </a>
            </li>
            <li >
                <a href="/blog/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>标签</span>
                </a>
            </li>
            <li >
                <a href="/blog/archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>存档</span>
                </a>
            </li>
            <li >
                <a href="/blog/collect/">
                    <i class="iconfont icon-shoucang1"></i>
                    <span>收藏</span>
                </a>
            </li>
            <li >
                <a href="/blog/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>关于</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>搜索</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E5%99%A8"><span class="toc-text">生成器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E5%99%A8%E5%9F%BA%E7%A1%80"><span class="toc-text">生成器基础</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#yield%E4%B8%AD%E6%96%AD%E6%89%A7%E8%A1%8C"><span class="toc-text">yield中断执行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E5%99%A8%E5%AF%B9%E8%B1%A1%E5%8F%AF%E4%BD%9C%E4%B8%BA%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%AF%B9%E8%B1%A1"><span class="toc-text">生成器对象可作为迭代器对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8yield%E5%AE%9E%E7%8E%B0%E8%BE%93%E5%85%A5%E5%92%8C%E8%BE%93%E5%87%BA"><span class="toc-text">使用yield实现输入和输出</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%A7%E7%94%9F%E5%8F%AF%E8%BF%AD%E4%BB%A3%E5%AF%B9%E8%B1%A1"><span class="toc-text">产生可迭代对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E5%99%A8%E4%BD%9C%E4%B8%BA%E9%BB%98%E8%AE%A4%E8%BF%AD%E4%BB%A3%E5%99%A8"><span class="toc-text">生成器作为默认迭代器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8F%90%E5%89%8D%E7%BB%88%E6%AD%A2%E7%94%9F%E6%88%90%E5%99%A8"><span class="toc-text">提前终止生成器</span></a></li></ol></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-bg" id="search-bg"></div>
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">搜索</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>

        <div class="index-about-mobile">
            <i> 思考、生活、编程 </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        生成器
    </div>

    <div class="post-meta">
        <span class="attr">发布于：<span>2023-05-05 23:12:20</span></span>
        
        <span class="attr">标签：/
        
        <a class="tag" href="/blog/tags/#JavaScript" title="JavaScript">JavaScript</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">访问：<span id="busuanzi_value_page_pv"></span>
</span>
</span>
    </div>
    <div class="post-content ">
        <h3 id="生成器"><a href="#生成器" class="headerlink" title="生成器"></a>生成器</h3><p>生成器是一个拥有在函数块内暂停和恢复代码执行能力的结构。</p>
<h4 id="生成器基础"><a href="#生成器基础" class="headerlink" title="生成器基础"></a>生成器基础</h4><p>1.生成器形式是一个函数，在函数名称前面加一个星号(*)表示他是一个生成器。只要可以定义函数的地方，就可以定义生成器。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 声明一个生成器函数</span></span><br><span class="line"><span class="keyword">function</span> *<span class="title function_">generatorFn</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 生成器函数表达式</span></span><br><span class="line"><span class="keyword">let</span> generatorFn = <span class="keyword">function</span> *()&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标识生成器函数的星号不受两侧的空格影响</span></span><br><span class="line"><span class="comment">//等价的生成器函数</span></span><br><span class="line"><span class="keyword">function</span>* <span class="title function_">generatorFn</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line"><span class="keyword">function</span> *<span class="title function_">generatorFn</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line"><span class="keyword">function</span> * <span class="title function_">generatorFn</span>(<span class="params"></span>)&#123;&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>箭头函数不能用来定义生成器函数</p>
</blockquote>
<p>2.调用生成器函数会产生一个<b>生成器对象</b>。生成器对象一开始处于暂停执行的状态。</p>
<p>3.生成器对象实现了<code>Iterator</code>接口，拥有<code>next()</code>方法。调用该方法会让生成器开始或者恢复执行。</p>
<p>4.<code>next()</code>方法的返回值类似于迭代器，返回<code>&#123;done:true/false,value&#125;</code>，如果函数体为空，调用<code>next()</code>后函数不会暂停，会返回<code>done:true</code>,如何该函数有返回值 则value的属性值就是该返回值，如果没有返回值，value属性值为<code>undefined</code>。</p>
<p>5.生成器函数只会在初次调用<code>next()</code>方法后开始执行。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">generatorFn</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;foobar&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> generatorObject=<span class="title function_">generatorFn</span>();<span class="comment">// 初次调用生成器函数并不会执行，没有打印控制台日志</span></span><br><span class="line"></span><br><span class="line">generatorObject.<span class="title function_">next</span>();<span class="comment">//foobar</span></span><br></pre></td></tr></table></figure>

<p>6.生成器对象实现了Iterable接口，他们的默认迭代器是自引用的。</p>
<p>实现了<code>Iterable</code> 接口表示 生成器函数包含<code>[Symbol.iterator]()</code>工厂函数，可以通过调用该工厂函数产生一个新的迭代器。</p>
<p><b>自引用的意思就是表示 在调用生成器函数的时候不光是产生了一个生成器对象，也自动调用了<code>[Symbol.iterator]()</code>工厂函数，产生了一个实现了迭代器协议的对象。所以产生的生成器对象可以使用<code>next()</code>方法。</b></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> *<span class="title function_">generatorFn</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> g = <span class="title function_">generatorFn</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(g===g[<span class="title class_">Symbol</span>.<span class="property">iterator</span>]());<span class="comment">//true</span></span><br></pre></td></tr></table></figure>

<h4 id="yield中断执行"><a href="#yield中断执行" class="headerlink" title="yield中断执行"></a>yield中断执行</h4><p>1.yield关键字可以让生成器停止和开始执行。生成器在遇到yield关键字之前会正常执行，遇到这个关键字之后，执行会停止，函数作用域的状态会保留。停止的生成器函数只能通过在生成器对象上调用<code>next()</code>方法来恢复执行。</p>
<p>2.yield关键值生成的值，会出现在<code>next()</code>方法返回的对象里。通过yield关键字退出的生成器函数会处在<code>done:false</code>状态，通过return关键字退出的生成器函数会处于<code>done:true</code>状态。</p>
<p>3.生成器函数内部的执行流程会针对每个生成器对象区分作用域。在一个生成器对象上调用<code>next()</code>不会影响其他生成器。</p>
<p>4.yield关键字只能在生成器函数内部使用，用在生成器嵌套的非生成器函数中也不可以。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> *<span class="title function_">generatorFn</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">yield</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> generatorObject=<span class="title function_">generatorFn</span>()</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(generatorObject.<span class="title function_">next</span>());<span class="comment">//&#123;done:false,value:undefined&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(generatorObject.<span class="title function_">nect</span>());<span class="comment">//&#123;done:true,value:undefined&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> *<span class="title function_">generatorFn1</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="string">&#x27;foo&#x27;</span>;</span><br><span class="line">  <span class="keyword">yield</span> <span class="string">&#x27;bar&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;baz&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> generatorObject1=<span class="title function_">generatorFn1</span>()</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(generatorObject1.<span class="title function_">next</span>());<span class="comment">//&#123;done:false,value:&#x27;foo&#x27;&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(generatorObject1.<span class="title function_">nect</span>());<span class="comment">//&#123;done:false,value:&#x27;bar&#x27;&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(generatorObject1.<span class="title function_">nect</span>());<span class="comment">//&#123;done:true,value:&#x27;baz&#x27;&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="生成器对象可作为迭代器对象"><a href="#生成器对象可作为迭代器对象" class="headerlink" title="生成器对象可作为迭代器对象"></a>生成器对象可作为迭代器对象</h4><p>因为上面说到生成器对象实现了Iterable接口，他们的默认迭代器是自引用的，所以生成器函数产生的对象也可以作为一个可迭代对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> *<span class="title function_">nTimes</span>(<span class="params">n</span>)&#123;</span><br><span class="line">  <span class="keyword">while</span>(n--)&#123;</span><br><span class="line">    <span class="keyword">yield</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">of</span> <span class="title function_">nTimes</span>(<span class="number">3</span>))&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;foo&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//foo</span></span><br><span class="line"><span class="comment">//foo</span></span><br><span class="line"><span class="comment">//foo</span></span><br></pre></td></tr></table></figure>

<h4 id="使用yield实现输入和输出"><a href="#使用yield实现输入和输出" class="headerlink" title="使用yield实现输入和输出"></a>使用yield实现输入和输出</h4><p>yield在上述代码示例中一直是作为函数的中间返回语句使用，yield关键字还可以作为函数的中间参数使用。<b>上一次导致函数暂停的yield关键字，可以接收到生成器对象在下一次调用<code>next()</code>方法时候写入的第一个值。生成器对象第一次调用<code>next()</code>传入的值不会被使用到，因为第一次调用是为了开始执行生成器函数。</b></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> *<span class="title function_">generatorFn</span>(<span class="params">initial</span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(initial);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">yield</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">yield</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> generatorObject=<span class="title function_">generatorFn</span>(<span class="string">&#x27;foo&#x27;</span>)</span><br><span class="line">generatorObject.<span class="title function_">next</span>(<span class="string">&#x27;bar&#x27;</span>);<span class="comment">//foo 第一次调用next()传入的值不会被使用</span></span><br><span class="line">generatorObject.<span class="title function_">next</span>(<span class="string">&#x27;baz&#x27;</span>);<span class="comment">//baz</span></span><br><span class="line">generatorObject.<span class="title function_">next</span>(<span class="string">&#x27;qux&#x27;</span>);<span class="comment">//qux</span></span><br><span class="line"><span class="comment">// yield关键字可以同时用于输入和输出</span></span><br><span class="line"><span class="keyword">function</span> *<span class="title function_">generatorFn1</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">yield</span> <span class="string">&#x27;foo&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> generatorObject1=<span class="title function_">generatorFn1</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(generatorObject1.<span class="title function_">next</span>());<span class="comment">//&#123;done:false,value:&#x27;foo&#x27;&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(generatorObject1.<span class="title function_">next</span>(<span class="string">&#x27;bar&#x27;</span>));<span class="comment">//&#123;done:true,value:&#x27;bar&#x27;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// yield关键字在一个生成器函数中可以使用多次</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span>* <span class="title function_">nTimes</span>(<span class="params">n</span>)&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">    <span class="keyword">yield</span> i;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> x <span class="keyword">of</span> <span class="title function_">nTimes</span>(<span class="number">3</span>))&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//0</span></span><br><span class="line"><span class="comment">//1</span></span><br><span class="line"><span class="comment">//2</span></span><br></pre></td></tr></table></figure>

<h4 id="产生可迭代对象"><a href="#产生可迭代对象" class="headerlink" title="产生可迭代对象"></a>产生可迭代对象</h4><p>在yield关键字后面可以加上一个*(星号)，来增强yield的行为，让他能够迭代一个可迭代对象，从而一次产出一个值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 等价的generatorFn</span></span><br><span class="line"><span class="keyword">function</span> * <span class="title function_">generatorFn</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">const</span> x <span class="keyword">of</span> [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])&#123;</span><br><span class="line">    <span class="keyword">yield</span> x;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> *<span class="title function_">generatorFn</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">yield</span>* [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// yield星号两侧的空格不影响其行为</span></span><br><span class="line"><span class="keyword">function</span> *<span class="title function_">generatorFn</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">yield</span>* [<span class="number">1</span>,<span class="number">2</span>];</span><br><span class="line">  <span class="keyword">yield</span> *[<span class="number">3</span>,<span class="number">4</span>];</span><br><span class="line">  <span class="keyword">yield</span> * [<span class="number">5</span>,<span class="number">6</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><b>yield*的值是关联迭代器返回<code>done:true</code>时的value属性。</b>对于普通迭代器来说该值是undefined，对于生成器函数产生的迭代器来说，这个值就是生成器函数返回的值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">generatorFn</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;iter value:&#x27;</span>, <span class="keyword">yield</span>* [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> x <span class="keyword">of</span> <span class="title function_">generatorFn</span>()) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;value:&#x27;</span>, x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// value: 1 </span></span><br><span class="line"><span class="comment">// value: 2</span></span><br><span class="line"><span class="comment">// value: 3</span></span><br><span class="line"><span class="comment">// iter value: undefined</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 生成器函数作为迭代器使用的时候</span></span><br><span class="line"><span class="keyword">function</span>* <span class="title function_">innerGeneratorFn</span>(<span class="params"></span>) &#123; </span><br><span class="line">  <span class="keyword">yield</span> <span class="string">&#x27;foo&#x27;</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&#x27;bar&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span>* <span class="title function_">outerGeneratorFn</span>(<span class="params">genObj</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;iter value:&#x27;</span>, <span class="keyword">yield</span>* <span class="title function_">innerGeneratorFn</span>());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> x <span class="keyword">of</span> <span class="title function_">outerGeneratorFn</span>()) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;value:&#x27;</span>, x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// value: foo</span></span><br><span class="line"><span class="comment">// iter value: bar</span></span><br></pre></td></tr></table></figure>

<h4 id="生成器作为默认迭代器"><a href="#生成器作为默认迭代器" class="headerlink" title="生成器作为默认迭代器"></a>生成器作为默认迭代器</h4><p>生成器函数调用后产生的生成器对象实现了Iterable接口，生成器函数和默认迭代器被调用之后都产生迭代器，所以生成器可以作为默认迭代器。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span>&#123;</span><br><span class="line">  constructor&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">values</span>=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">  &#125;</span><br><span class="line">	* [<span class="title class_">Symbol</span>.<span class="property">iterator</span>]()&#123;</span><br><span class="line">    <span class="keyword">yield</span>* <span class="variable language_">this</span>.<span class="property">values</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> f = <span class="keyword">new</span> <span class="title class_">Foo</span>();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">const</span> x <span class="keyword">of</span> f)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(x)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//1</span></span><br><span class="line"><span class="comment">//2</span></span><br><span class="line"><span class="comment">//3</span></span><br></pre></td></tr></table></figure>

<h4 id="提前终止生成器"><a href="#提前终止生成器" class="headerlink" title="提前终止生成器"></a>提前终止生成器</h4><p>1.return</p>
<p><code>return()</code>方法会强制生成器进入关闭状态，提供给<code>return()</code> 方法的值，就是终止迭代器对象的值。</p>
<p>与迭代器不同，所有生成器对象都有 <code>return()</code>方法，只要通过它进入关闭状态，就无法恢复了。 后续调用 <code>next()</code>会显示 <code>done: true</code> 状态，而提供的任何返回值都不会被存储或传播.</p>
<p><code>for-of</code>循环等内置语言结构会忽略状态为<code>done:true</code>的<code>IteratorObject</code>内部返回的值。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> *<span class="title function_">generatorFn</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">const</span> x <span class="keyword">of</span> [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])&#123;</span><br><span class="line">    <span class="keyword">yield</span> x</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> g = <span class="title function_">generatorFn</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(g.<span class="title function_">next</span>());<span class="comment">//&#123;done:true,value:1&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(g.<span class="keyword">return</span>(<span class="number">4</span>));<span class="comment">//&#123;done:true,value:4&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(g.<span class="title function_">next</span>());<span class="comment">//&#123;done:true,value:undefined&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 忽略done：true的返回值</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">const</span> x <span class="keyword">of</span> g)&#123;</span><br><span class="line">  <span class="keyword">if</span>(x&gt;<span class="number">1</span>)&#123;</span><br><span class="line">    g.<span class="keyword">return</span>(<span class="number">4</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(x)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//1</span></span><br><span class="line"><span class="comment">//2</span></span><br></pre></td></tr></table></figure>

<p>2.throw()</p>
<p><code>throw()</code>方法会在生成器执行<b>暂停</b>的时候将一个提供的错误注入到生成器对象中。如果错误未被处理，生成器就会关闭。</p>
<p>但如果生成器<b>内部</b>处理了这个错误，那么生成器就不会关闭，而且还可以恢复执行，错误处理会跳过对应的yield。</p>
<blockquote>
<p> 如果生成器对象还没有开始执行，那么调用throw()抛出的错误不会在函数内部被 捕获，因为这相当于在函数块外部抛出了错误。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">generatorFn</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">const</span> x <span class="keyword">of</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]) &#123;</span><br><span class="line">				<span class="keyword">yield</span> x; </span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> g = <span class="title function_">generatorFn</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(g);   <span class="comment">// generatorFn &#123;&lt;suspended&gt;&#125;</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      g.<span class="keyword">throw</span>(<span class="string">&#x27;foo&#x27;</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(e); <span class="comment">// foo</span></span><br><span class="line">		&#125;		</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(g);   <span class="comment">// generatorFn &#123;&lt;closed&gt;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> *<span class="title function_">generatorFn</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">const</span> x <span class="keyword">of</span> [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])&#123;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">      <span class="keyword">yield</span> x</span><br><span class="line">    &#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line">      </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> g=<span class="title function_">generatorFn</span>()</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(g.<span class="title function_">next</span>());<span class="comment">//&#123;done:false,value:1&#125;</span></span><br><span class="line">g.<span class="keyword">throw</span>(<span class="string">&#x27;foo&#x27;</span>);<span class="comment">// 注入错误在生成器函数内部被捕捉然后被yield抛出，所以对应的yield会跳过。</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(g.<span class="title function_">next</span>());<span class="comment">//&#123;done:false,value:3&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


        
        <br />
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>
        <div id="lv-container"></div>
        <div class="giscus"></div>
    </div>
</div>

    </div>
</div>

<footer class="footer">
  <ul class="list-inline text-center">
         
  </ul>
  
  <p>
    <span id="busuanzi_container_site_pv">
      <span id="busuanzi_value_site_pv"></span>PV
    </span>
    <span id="busuanzi_container_site_uv">
      <span id="busuanzi_value_site_uv"></span>UV
    </span>
    Created By <a target="_blank" rel="noopener" href="https://github.com/CaptainTyL">Captain</a>
  </p>
</footer>


</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/blog/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>

<script src="/blog/js/index.js"></script>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




    <script src="https://giscus.app/client.js"
  data-repo="CaptainTyL/blog"
  data-repo-id="R_kgDOI_BgkA"
  data-category="Announcements"
  data-category-id="DIC_kwDOI_BgkM4CU_7C"
  data-mapping="title"
  data-strict="0"
  data-reactions-enabled="1"
  data-emit-metadata="0"
  data-input-position="bottom"
  data-theme="light"
  data-lang="zh-CN"
  crossorigin="anonymous"
  async>
</script>




</html>
